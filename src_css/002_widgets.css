/* --- Ailey & Bailey Canvas --- */
/* File: 002_widgets.css */
/* Version: 14.1 (Header Toggle Button) */
/* Description: Added styles for the new header toggle button. */

/* --- Styles for elements inside Immersive Header --- */
#system-info-widget { text-align: left; }
#real-time-clock { font-size: 0.9em; font-weight: bold; }
#canvas-id-container { font-size: 0.75em; opacity: 0.7; margin-top: 2px; display: flex; align-items: center; gap: 8px; }
#copy-canvas-id { cursor: pointer; display: inline-flex; align-items: center; justify-content: center; transition: transform 0.2s; }
#copy-canvas-id svg { fill: currentColor; }
#copy-canvas-id:hover { transform: scale(1.2); }

#selection-popover { position: absolute; display: none; background-color: #333; color: white; border-radius: 8px; padding: 5px; gap: 5px; z-index: 1600; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
#selection-popover button { background-color: #4a4a4a; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }
#selection-popover button:hover { background-color: #5f5f5f; }
#selection-popover button svg { fill: currentColor; }

.custom-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 2000; }
.custom-modal { padding: 30px; border-radius: 10px; width: 90%; max-width: 450px; text-align: center; }
body:not(.dark-mode) .custom-modal { background-color: var(--bg-color-light); }
body.dark-mode .custom-modal { background-color: var(--container-bg-dark); }
.custom-modal-actions { margin-top: 20px; display: flex; justify-content: center; gap: 15px; }
.modal-btn { padding: 10px 25px; border-radius: 5px; border: none; cursor: pointer; }
#modal-confirm-btn, #prompt-save-btn, #api-settings-save-btn { background-color: #8C6D46; color: white; }
#modal-cancel-btn, #prompt-cancel-btn, #api-settings-cancel-btn { background-color: #888; color: white; }

#copy-modal-container { padding: 20px; max-width: 600px; width: 90%; }
#copy-modal-container p { margin-top: 0; margin-bottom: 15px; font-size: 1.1em; }
#copy-modal-textarea { width: 100%; height: 300px; font-family: "D2Coding", "Consolas", monospace; font-size: 0.9em; padding: 10px; border-radius: 6px; resize: none; }
body:not(.dark-mode) #copy-modal-textarea { border-color: var(--border-color-light); background-color: white; color: var(--text-color-light); }
body.dark-mode #copy-modal-textarea { border-color: var(--border-color-dark); background-color: var(--quote-bg-dark); color: var(--text-color-dark); }

.api-settings-modal { max-width: 650px; text-align: left; }
.api-settings-modal h3 { display: flex; align-items: center; gap: 10px; justify-content: center; margin-bottom: 10px; }
.api-modal-desc { font-size: 0.9em; text-align: center; margin-bottom: 30px; opacity: 0.8; }
.api-form-section { margin-bottom: 25px; }
.api-form-section label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 1em; }
.api-form-section small { font-size: 0.8em; opacity: 0.7; display: block; margin-top: 5px; }
.api-key-wrapper { display: flex; gap: 10px; align-items: center; }
.api-settings-modal input[type="text"], .api-settings-modal input[type="password"], .api-settings-modal input[type="number"], .api-settings-modal select { width: 100%; padding: 10px 12px; border-radius: 6px; border: 1px solid var(--border-color-dark); background-color: var(--bg-color-dark); color: var(--text-color-dark); font-family: 'Gowun Batang', serif; font-size: 1em; box-sizing: border-box; }
body:not(.dark-mode) .api-settings-modal input, body:not(.dark-mode) .api-settings-modal select { border-color: var(--border-color-light); background-color: white; color: var(--text-color-light); }
.api-key-wrapper input { flex-grow: 1; }
#verify-api-key-btn { padding: 10px 15px; border-radius: 6px; border: none; cursor: pointer; background-color: var(--h2-color-dark); color: white; white-space: nowrap; font-family: 'Gowun Batang', serif; }
body:not(.dark-mode) #verify-api-key-btn { background-color: var(--h2-color-light); }
#verify-api-key-btn:disabled { opacity: 0.5; cursor: not-allowed; }
#api-key-status { font-size: 0.85em; margin-top: 8px; min-height: 1.2em; font-weight: bold; }
.status-loading { color: var(--h2-color-dark); }
body:not(.dark-mode) .status-loading { color: var(--h2-color-light); }
.status-success { color: var(--correct-color-dark); }
body:not(.dark-mode) .status-success { color: var(--correct-color); }
.status-error { color: var(--incorrect-color-dark); }
body:not(.dark-mode) .status-error { color: var(--incorrect-color); }
.token-limit-wrapper { max-width: 250px; }
.token-usage-section { padding: 15px; border-radius: 8px; margin-top: 10px; }
body:not(.dark-mode) .token-usage-section { background-color: var(--quote-bg-light); }
body.dark-mode .token-usage-section { background-color: var(--quote-bg-dark); }
#token-usage-display { font-size: 1.1em; margin-bottom: 15px; display: flex; flex-wrap: wrap; gap: 15px; align-items: center; }
#token-usage-display strong { color: var(--header-color-dark); }
body:not(.dark-mode) #token-usage-display strong { color: var(--header-color-light); }
#reset-token-usage-btn { background: none; border: 1px solid; color: inherit; font-size: 0.8em; padding: 4px 10px; border-radius: 12px; cursor: pointer; opacity: 0.7; transition: opacity 0.2s; }
#reset-token-usage-btn:hover { opacity: 1; }
#api-settings-reset-btn { background-color: #a94442; color: white; }
#api-settings-reset-btn:hover { background-color: #8a2a27; }
#quiz-modal-overlay { background: rgba(0,0,0,0.7); }
.quiz-modal { width: 90%; max-width: 600px; }
body:not(.dark-mode) .quiz-modal { background-color: var(--bg-color-light); }
body.dark-mode .quiz-modal { background-color: var(--container-bg-dark); }
#quiz-container { margin-bottom: 20px; }
.quiz-question-block { margin-bottom: 25px; border-left: 3px solid var(--h2-border-light); padding-left: 15px; }
body:dark-mode .quiz-question-block { border-left-color: var(--h2-border-dark); }
.quiz-question-block p { font-weight: bold; font-size: 1.1em; }
.quiz-options label { display: block; margin: 8px 0; padding: 10px; border-radius: 5px; cursor: pointer; border: 1px solid transparent; transition: all 0.2s; }
body:not(.dark-mode) .quiz-options label:hover { background-color: var(--quote-bg-light); }
body.dark-mode .quiz-options label:hover { background-color: var(--quote-bg-dark); }
.quiz-options input[type="radio"] { margin-right: 10px; }
#quiz-submit-btn { padding: 10px 25px; border-radius: 5px; border: none; cursor: pointer; background-color: var(--h2-color-dark); color: white; font-weight: bold; }
body:not(:dark-mode) #quiz-submit-btn { background-color: var(--h2-color-light); }
#quiz-results { margin-top: 20px; font-weight: bold; font-size: 1.2em; }
#prompt-modal-overlay textarea { width: 100%; height: 150px; margin-top: 15px; padding: 10px; border-radius: 5px; border: 1px solid var(--border-color-dark); background: var(--bg-color-dark); color: var(--text-color-dark); }
body:not(.dark-mode) #prompt-modal-overlay textarea { border-color: var(--border-color-light); background: var(--bg-color-light); color: var(--text-color-light); }
@keyframes toast-in { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
@keyframes toast-out { from { transform: translateX(0); opacity: 1; } to { transform: translateX(120%); opacity: 0; } }
.toast-notification { position: fixed; top: 20px; right: 20px; min-width: 250px; max-width: 350px; border-radius: 8px; padding: 15px 20px; box-shadow: 0 8px 24px rgba(0,0,0,0.15); z-index: 9999; display: flex; align-items: center; gap: 15px; cursor: pointer; animation: toast-in 0.4s cubic-bezier(0.215, 0.610, 0.355, 1) forwards; }
.toast-notification.exiting { animation: toast-out 0.4s ease-out forwards; }
body.dark-mode .toast-notification { background-color: var(--container-bg-dark); color: var(--text-color-dark); border: 1px solid var(--border-color-dark); }
body:not(.dark-mode) .toast-notification { background-color: var(--container-bg-light); color: var(--text-color-light); border: 1px solid var(--border-color-light); }
.toast-icon { font-size: 1.5em; line-height: 0; }
.toast-content p { margin: 0; font-weight: bold; font-size: 0.95em; }
.toast-content small { margin-top: 4px; display: block; opacity: 0.7; font-size: 0.85em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* --- [PATCH] Header Toggle Button & Hiding Logic --- */
#header-toggle-btn {
    position: fixed;
    bottom: 20px;
    left: 20px;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    z-index: 1500;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    opacity: 0.4; /* Default semi-transparent state */
    transform: scale(1);
    transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out, background-color 0.3s, color 0.3s;
}

#header-toggle-btn:hover {
    opacity: 1; /* Fully opaque on hover */
    transform: scale(1.1);
}

body:not(.dark-mode) #header-toggle-btn {
    background-color: var(--container-bg-light);
    border: 1px solid var(--border-color-light);
    color: var(--text-color-light);
}

body.dark-mode #header-toggle-btn {
    background-color: var(--container-bg-dark);
    border: 1px solid var(--border-color-dark);
    color: var(--text-color-dark);
}

body.header-toggled-off #immersive-header {
    transform: translateY(-120%) !important; /* Ensure it hides completely */
    pointer-events: none;
}